---

title: Overview

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00a_demo.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">storage_tools.core</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="k">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">List</span><span class="p">,</span><span class="n">Tuple</span><span class="p">,</span><span class="n">Optional</span><span class="p">,</span><span class="n">Union</span>
<span class="kn">import</span> <span class="nn">shutil</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="You-can-run-this-notebook-using-...">You can run this notebook using ...<a class="anchor-link" href="#You-can-run-this-notebook-using-..."> </a></h2><h3 id="Azure">Azure<a class="anchor-link" href="#Azure"> </a></h3><p>To run this notebook you'll need read/write access to an azure blob store and have a <code>[azure_demo]</code> section configured in <code>secrets/settings.ini</code>.</p>
<p>Then set <code>storage_name='azure_demo'</code> at the top of the next cell.</p>
<h3 id="AWS">AWS<a class="anchor-link" href="#AWS"> </a></h3><p>To run this notebook you'll need read/write access to an s3 bucket and have a <code>[aws_demo]</code> section configured in <code>secrets/settings.ini</code>.</p>
<p>Then set <code>storage_name='aws_demo'</code> at the top of the next cell.</p>
<h3 id="or-local-storage">or local storage<a class="anchor-link" href="#or-local-storage"> </a></h3><p>Just set <code>storage_name='local_test'</code> at the top of the next cell.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># storage_name=&#39;aws_demo&#39;</span>
<span class="n">storage_name</span><span class="o">=</span><span class="s1">&#39;local_test&#39;</span>

<span class="k">if</span> <span class="n">storage_name</span><span class="o">==</span><span class="s1">&#39;azure_demo&#39;</span><span class="p">:</span>
    <span class="n">storage_client</span><span class="o">=</span><span class="n">new_storage_client</span><span class="p">(</span><span class="s1">&#39;azure_demo&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">clean_remote</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">storage_client</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="n">name_starts_with</span><span class="o">=</span><span class="s1">&#39;demos/demo_&#39;</span><span class="p">):</span>
            <span class="n">storage_client</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">delete_blob</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        
<span class="k">elif</span> <span class="n">storage_name</span><span class="o">==</span><span class="s1">&#39;aws_demo&#39;</span><span class="p">:</span>
    <span class="n">storage_client</span><span class="o">=</span><span class="n">new_storage_client</span><span class="p">(</span><span class="s1">&#39;aws_demo&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">clean_remote</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">storage_client</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="n">name_starts_with</span><span class="o">=</span><span class="s1">&#39;demos/demo_&#39;</span><span class="p">):</span>
            <span class="n">storage_client</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">delete_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">storage_client</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;bucket&#39;</span><span class="p">],</span><span class="n">Key</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">storage_client</span><span class="o">=</span><span class="n">new_storage_client</span><span class="p">(</span><span class="s1">&#39;local_test&#39;</span><span class="p">,</span><span class="s1">&#39;test/settings.ini&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">clean_remote</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span> <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">storage_client</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;storage_area&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;/demos&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span> <span class="k">pass</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Using&#39;</span><span class="p">,</span><span class="n">storage_client</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">clean_local</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span> <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">storage_client</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;local_path&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;/demos&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span> <span class="k">pass</span>
    
<span class="n">clean_local</span><span class="p">()</span>
<span class="n">clean_remote</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Using &lt;storage_tools.core.LocalStorageClient object at 0x00000239AD39BF88&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note: normally you would do something like <code>storage_client=new_storage_client('azure_demo')</code> to create a storage client. Feel free to ignore the extra code in the above cell - it handles data cleanup etc so that we can run the demo multiple times.</p>
<h2 id="The-next-3-cells-us-storage_client.ls-to-see-what's-in-both-remote-and-local-storage">The next 3 cells us <code>storage_client.ls</code> to see what's in both remote and local storage<a class="anchor-link" href="#The-next-3-cells-us-storage_client.ls-to-see-what's-in-both-remote-and-local-storage"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">storage_client</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">storage_client</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="n">name_starts_with</span><span class="o">=</span><span class="s1">&#39;For&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">storage_client</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">&#39;local_path&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Now-we-can-create-a-dataset-in-local-storage">Now we can create a dataset in local storage<a class="anchor-link" href="#Now-we-can-create-a-dataset-in-local-storage"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset_name</span><span class="o">=</span><span class="s1">&#39;demos/demo_0&#39;</span>
<span class="n">path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">storage_client</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;local_path&#39;</span><span class="p">])</span><span class="o">/</span><span class="n">dataset_name</span>
<span class="n">path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;txt&#39;</span><span class="p">,</span><span class="s1">&#39;csv&#39;</span><span class="p">,</span><span class="s1">&#39;png&#39;</span><span class="p">]:</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;test/test_data.</span><span class="si">{ext}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">path</span><span class="o">/</span><span class="n">f</span><span class="s1">&#39;test_data.</span><span class="si">{ext}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">storage_client</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">&#39;local_path&#39;</span><span class="p">,</span><span class="n">dataset_name</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;demos/demo_0/test_data.csv&#39;,
 &#39;demos/demo_0/test_data.png&#39;,
 &#39;demos/demo_0/test_data.txt&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Upload-the-dataset-and-storage_client.ls-to-show-it-got-uploaded">Upload the dataset and <code>storage_client.ls</code> to show it got uploaded<a class="anchor-link" href="#Upload-the-dataset-and-storage_client.ls-to-show-it-got-uploaded"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">storage_client</span><span class="o">.</span><span class="n">upload_dataset</span><span class="p">(</span><span class="n">dataset_name</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>WindowsPath(&#39;test/storage_area/demos/demo_0.0.0.1.zip&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">storage_client</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;demos/demo_0.0.0.1.zip&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Delete-our-local-copy-so-we-can-download-from-remote-storage">Delete our local copy so we can download from remote storage<a class="anchor-link" href="#Delete-our-local-copy-so-we-can-download-from-remote-storage"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clean_local</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">local_dataset</span><span class="o">=</span><span class="n">storage_client</span><span class="o">.</span><span class="n">download_dataset</span><span class="p">(</span><span class="n">dataset_name</span><span class="p">)</span>
<span class="n">local_dataset</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>WindowsPath(&#39;test/local_path/demos/demo_0.0.0.1&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Display-a-file-from-the-dataset">Display a file from the dataset<a class="anchor-link" href="#Display-a-file-from-the-dataset"> </a></h2><p>This image was uploaded to remote storage as part of the 'demos/demo_0' dataset then, downloaded from remote to local</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">local_dataset</span><span class="o">/</span><span class="s1">&#39;test_data.png&#39;</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-3-21edfe44af1e&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">      1</span> <span class="ansi-green-intense-fg ansi-bold">from</span> IPython<span class="ansi-yellow-intense-fg ansi-bold">.</span>display <span class="ansi-green-intense-fg ansi-bold">import</span> Image
<span class="ansi-green-intense-fg ansi-bold">----&gt; 2</span><span class="ansi-yellow-intense-fg ansi-bold"> </span>Image<span class="ansi-yellow-intense-fg ansi-bold">(</span>filename<span class="ansi-yellow-intense-fg ansi-bold">=</span>local_dataset<span class="ansi-yellow-intense-fg ansi-bold">/</span><span class="ansi-blue-intense-fg ansi-bold">&#39;test_data.png&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-red-intense-fg ansi-bold">NameError</span>: name &#39;local_dataset&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Clean-up-local-and-remote-files-if-you-like">Clean-up local and remote files if you like<a class="anchor-link" href="#Clean-up-local-and-remote-files-if-you-like"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clean_local</span><span class="p">()</span>
<span class="n">clean_remote</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

